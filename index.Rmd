---
title: "Análisis Exploratorio de Datos: Student Performance UCI"
author: "Nino Cabrera, Mateo Chang y Dario Quiroga"
date: "`r Sys.Date()`"
site: bookdown::bookdown_site
Dataset: UCI Student Performance Data Set
documentclass: book
output:
  bookdown::gitbook: default
---

# Resumen del Analisis

Este documento presenta un análisis exploratorio exhaustivo del dataset "Student Performance" de la Universidad de California Irvine (UCI), que contiene información sobre el rendimiento académico de estudiantes portugueses en dos materias: Matemáticas y Lengua Portuguesa. El análisis busca identificar patrones, relaciones y factores determinantes del éxito académico estudiantil.

**Hallazgos principales:**
- Diferencias significativas en el rendimiento entre materias
- Impacto considerable de factores socioeconómicos y familiares
- Patrones distintivos en las variables predictoras del éxito académico

---

##  Introducción y Objetivos

### Contexto del Dataset

El dataset Student Performance contiene información de estudiantes de educación secundaria portugueses, recopilada en dos escuelas durante el período académico 2005-2006. Los datos incluyen 33 variables que abarcan desde características demográficas hasta factores socioeconómicos, familiares y académicos.

### Objetivos del Análisis

1. **Caracterizar el rendimiento académico** en ambas materias (Matemáticas y Portugués)
2. **Identificar patrones de valores perdidos** y evaluar la calidad de los datos
3. **Analizar relaciones bivariadas** entre variables predictoras y rendimiento final (G3)
4. **Comparar diferencias** en el rendimiento entre materias
5. **Identificar factores clave** asociados con el éxito/fracaso académico
6. **Proporcionar insights** para políticas educativas

---

## Preparación y Estructura de los Datos

```{r setup, include=FALSE}
knitr::opts_chunk$set(
  echo = TRUE, 
  warning = FALSE, 
  message = FALSE,
  fig.width = 10,
  fig.height = 6,
  dpi = 300
)
```

```{r packages-and-setup}
# Paquetes necesarios para el análisis
suppressPackageStartupMessages({
  library(tidyverse)    # Manipulación de datos y visualización
  library(GGally)       # Matrices de correlación y gráficos paired
  library(scales)       # Escalas para gráficos
  library(knitr)        # Tablas formateadas
  library(DT)           # Tablas interactivas
})

# Configuración del theme y paleta de colores
theme_set(theme_minimal(base_size = 12))
pal <- c("Math" = "#2B8CBE", "Portuguese" = "#E34A33")
```

### Carga y Limpieza de Datos

```{r data-loading}
# Carga de los datasets originales
mat <- read.delim("student-mat.csv", sep = ";")
por <- read.delim("student-por.csv", sep = ";")

# Estandarización de nombres de columnas
names(mat) <- tolower(gsub("\\.", "_", names(mat)))
names(por) <- tolower(gsub("\\.", "_", names(por)))

# Definición de tipos de variables
factor_vars_base  <- c("school","sex","address","famsize","pstatus","mjob","fjob","reason",
                       "guardian","schoolsup","famsup","paid","activities","nursery",
                       "higher","internet","romantic")

numeric_vars_base <- c("age","medu","fedu","traveltime","studytime","failures",
                       "famrel","freetime","goout","dalc","walc","health",
                       "absences","g1","g2","g3")

# Conversión de tipos de datos
mat[intersect(factor_vars_base,  names(mat))] <- 
  lapply(mat[intersect(factor_vars_base,  names(mat))], factor)
por[intersect(factor_vars_base,  names(por))] <- 
  lapply(por[intersect(factor_vars_base,  names(por))], factor)

mat[intersect(numeric_vars_base, names(mat))] <- 
  lapply(mat[intersect(numeric_vars_base, names(mat))], as.numeric)
por[intersect(numeric_vars_base, names(por))] <- 
  lapply(por[intersect(numeric_vars_base, names(por))], as.numeric)

# Eliminación de duplicados y variables no utilizadas
mat <- mat %>% distinct() %>% select(-any_of(c("famsize","nursery")))
por <- por %>% distinct() %>% select(-any_of(c("famsize","nursery")))

# Combinación de datasets con etiqueta de materia
mat$subject <- "Math"
por$subject <- "Portuguese" 
df_all <- bind_rows(mat, por) %>% relocate(subject)

# Actualización de listas de variables
factor_vars  <- intersect(factor_vars_base,  names(df_all))
numeric_vars <- intersect(numeric_vars_base, names(df_all))
```

### Descripción del Dataset Final

```{r dataset-summary}
# Resumen dimensional
cat("Dimensiones del dataset combinado:", dim(df_all)[1], "observaciones,", dim(df_all)[2], "variables\n")
cat("Matemáticas:", nrow(mat), "estudiantes\n")
cat("Portugués:", nrow(por), "estudiantes\n")

# Estructura de variables
cat("\n=== ESTRUCTURA DE VARIABLES ===\n")
cat("Variables categóricas (", length(factor_vars), "):", paste(factor_vars, collapse = ", "), "\n")
cat("Variables numéricas (", length(numeric_vars), "):", paste(numeric_vars, collapse = ", "), "\n")
```

**Interpretación:** El dataset combinado contiene `r nrow(df_all)` observaciones de estudiantes, con `r nrow(mat)` estudiantes de Matemáticas y `r nrow(por)` de Portugués. La estructura incluye `r length(factor_vars)` variables categóricas y `r length(numeric_vars)` numéricas, proporcionando una vista integral de factores demográficos, socioeconómicos y académicos.

---

## Análisis de Valores Perdidos

### Patrón General de Missingness

```{r missing-analysis}
# Análisis de valores perdidos por variable
na_summary_overall <- df_all %>%
  summarise(across(everything(), ~mean(is.na(.))*100)) %>%
  pivot_longer(everything(), names_to = "variable", values_to = "pct_na_overall")

# Análisis por materia
na_summary_by_subj <- df_all %>%
  group_by(subject) %>%
  summarise(across(everything(), ~mean(is.na(.))*100)) %>%
  pivot_longer(-subject, names_to = "variable", values_to = "pct_na") %>%
  left_join(na_summary_overall, by = "variable") %>%
  mutate(variable = fct_reorder(variable, pct_na_overall, .desc = TRUE))

# Tabla resumen de missingness
na_table <- na_summary_overall %>%
  filter(pct_na_overall > 0) %>%
  arrange(desc(pct_na_overall))

if(nrow(na_table) > 0) {
  kable(na_table, 
        caption = "Variables con valores perdidos",
        col.names = c("Variable", "% Valores Perdidos"),
        digits = 2)
} else {
  cat("No se detectaron valores perdidos en el dataset")
}
```

```{r missing-visualization, fig.cap="Análisis visual de valores perdidos por materia"}
# Visualización de valores perdidos
ggplot(na_summary_by_subj, aes(variable, pct_na, fill = subject)) +
  geom_col(position = position_dodge(width = .8), width = .75) +
  coord_flip() +
  scale_y_continuous(labels = function(x) paste0(x, "%")) +
  scale_fill_manual(values = pal) +
  labs(title = "% de valores perdidos por variable y asignatura", 
       x = NULL, y = "% NA", fill = "Asignatura") +
  theme(legend.position = "bottom")
```

**Conclusión sobre Missingness:** 
`r if(max(na_summary_overall$pct_na_overall) == 0) {"Los datos están completos, sin valores perdidos, lo que indica una excelente calidad en la recolección de información. Esto elimina la necesidad de técnicas de imputación y permite proceder directamente con el análisis."} else {paste("Se detectaron valores perdidos en", sum(na_summary_overall$pct_na_overall > 0), "variables, con un máximo de", round(max(na_summary_overall$pct_na_overall), 1), "% de missingness.")}`

---
